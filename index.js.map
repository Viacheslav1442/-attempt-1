{"version":3,"file":"index.js","sources":["../src/js/soundwave-api.js","../src/js/artist-section.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst api = axios.create({\n  baseURL: 'https://sound-wave.b.goit.study/api',\n  timeout: 5000,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\napi.interceptors.response.use(\n  response => response,\n  error => {\n    // iziToast.error або alert на вибір\n    alert('Сталася помилка при запиті до сервера. Спробуйте ще раз.');\n    return Promise.reject(error);\n  }\n);\n\nexport async function fetchArtists() {\n  try {\n    const response = await api.get('/artists');\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n}\n\nexport async function fetchArtistById(id) {\n  try {\n    const response = await api.get(`/artists/${id}`);\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n}\n\nexport async function fetchReviews() {\n  try {\n    const response = await api.get('/reviews');\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n}","import { fetchArtists, fetchArtistById } from './soundwave-api.js';\n\nlet offset = 0;\nconst limit = 8;\nlet allArtists = [];\n\nlet artistsContainer;\nlet loadMoreBtn;\n\nfunction showLoader() {\n  const loader = document.getElementById('loader');\n  if (loader) loader.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  const loader = document.getElementById('loader');\n  if (loader) loader.classList.add('hidden');\n}\n\n// Оновлена функція getGenres\nfunction getGenres(artist) {\n  if (!artist) return 'N/A';\n\n  // Якщо є масив жанрів у форматі [{ genre: \"Rock\" }, ...]\n  if (Array.isArray(artist.genres) && artist.genres.length > 0) {\n    const genres = artist.genres\n      .map(g => g.genre)\n      .filter(Boolean)\n      .map(g => g.trim())\n      .filter((val, idx, arr) => arr.indexOf(val) === idx);\n\n    if (genres.length) return genres.join(', ');\n  }\n\n  // Якщо немає масиву genres, використовуємо старі поля\n  const genresFromFields = [\n    artist.strGenre,\n    artist.strGenre2,\n    artist.strGenre3,\n    artist.strStyle,\n    artist.strMood,\n    artist.strMood2,\n    artist.strMood3,\n  ]\n    .filter(val => typeof val === 'string' && val.trim())\n    .map(val => val.trim())\n    .filter((val, idx, arr) => arr.indexOf(val) === idx);\n\n  return genresFromFields.length ? genresFromFields.join(', ') : 'N/A';\n}\n\nasync function createCard(artist) {\n  const card = document.createElement('div');\n  card.className = 'artist-card';\n\n  // Завантажити детальні дані, якщо є id\n  let fullArtist = artist;\n  if (artist.idArtist) {\n    try {\n      const details = await fetchArtistById(artist.idArtist);\n      if (details?.artists?.[0]) {\n        fullArtist = details.artists[0];\n      }\n    } catch {\n      // Якщо помилка — залишаємо початкові дані\n    }\n  }\n\n  const img = document.createElement('img');\n  img.src =\n    fullArtist.strArtistThumb ||\n    'https://placehold.co/150x150/cccccc/333333?text=No+Image';\n  img.alt = fullArtist.strArtist || 'No Image';\n  img.addEventListener('error', function () {\n    if (!this.src.includes('placehold.co')) {\n      this.src = 'https://placehold.co/150x150/cccccc/333333?text=No+Image';\n      this.alt = 'No Image Available';\n    }\n  });\n  card.appendChild(img);\n\n  const h3 = document.createElement('h3');\n  h3.textContent = fullArtist.strArtist || 'Unknown Artist';\n  card.appendChild(h3);\n\n  const genresP = document.createElement('p');\n  const genresStrong = document.createElement('strong');\n  genresStrong.textContent = 'Genres: ';\n  genresP.appendChild(genresStrong);\n\n  const genresText = document.createTextNode(getGenres(fullArtist));\n  genresP.appendChild(genresText);\n  card.appendChild(genresP);\n\n  const shortInfoP = document.createElement('p');\n  shortInfoP.className = 'artist-description';\n  const bio = fullArtist.strBiographyEN || 'No short info available.';\n  shortInfoP.textContent = bio.length > 200 ? bio.slice(0, 200) + '...' : bio;\n  card.appendChild(shortInfoP);\n\n  const learnMoreButton = document.createElement('button');\n  learnMoreButton.className = 'learn-more-btn';\n  learnMoreButton.textContent = 'Learn More';\n\n  if (fullArtist.idArtist) {\n    learnMoreButton.dataset.artistId = fullArtist.idArtist;\n  } else {\n    learnMoreButton.disabled = true;\n  }\n\n  card.appendChild(learnMoreButton);\n\n  return card;\n}\n\nasync function loadArtistsDataAndDisplay() {\n  try {\n    showLoader();\n\n    if (offset === 0) {\n      const data = await fetchArtists();\n\n      const artistsArray = Array.isArray(data)\n        ? data\n        : Array.isArray(data.artists)\n          ? data.artists\n          : null;\n\n      if (!artistsArray) {\n        alert('Error: Received invalid data from server.');\n        loadMoreBtn?.classList.add('hidden');\n        loadMoreBtn?.setAttribute('disabled', true);\n        return;\n      }\n\n      allArtists = artistsArray;\n      artistsContainer.innerHTML = '';\n    }\n\n    const artistsToDisplay = allArtists.slice(offset, offset + limit);\n    for (const artist of artistsToDisplay) {\n      const card = await createCard(artist);\n      artistsContainer.appendChild(card);\n    }\n\n    offset += limit;\n\n    if (offset >= allArtists.length) {\n      loadMoreBtn?.classList.add('hidden');\n      loadMoreBtn?.setAttribute('disabled', true);\n    } else {\n      loadMoreBtn?.classList.remove('hidden');\n      loadMoreBtn?.removeAttribute('disabled');\n    }\n  } catch (error) {\n    alert('Failed to load artists. Please try again later.');\n    loadMoreBtn?.classList.add('hidden');\n    loadMoreBtn?.setAttribute('disabled', true);\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction initArtistSection() {\n  artistsContainer = document.getElementById('artistsContainer');\n  loadMoreBtn = document.getElementById('loadMoreBtn');\n\n  if (!artistsContainer || !loadMoreBtn) return;\n\n  loadMoreBtn.onclick = loadArtistsDataAndDisplay;\n  loadArtistsDataAndDisplay();\n\n  artistsContainer.addEventListener('click', async (e) => {\n    if (e.target.classList.contains('learn-more-btn')) {\n      const artistId = e.target.dataset.artistId;\n\n      if (!artistId) {\n        alert('Невідомий артист. Ідентифікатор відсутній.');\n        return;\n      }\n\n      try {\n        const artistData = await fetchArtistById(artistId);\n        if (!artistData || !artistData.artists || !artistData.artists[0]) {\n          alert('Artist details not found.');\n          return;\n        }\n\n        // Тут можна відкривати модальне вікно або інші дії з детальною інформацією\n        // console.log('Artist details:', artistData.artists[0]); // ← закоментовано\n      } catch (error) {\n        alert('Failed to load artist details.');\n      }\n    }\n  });\n}\n\nexport { initArtistSection };\n","import { initArtistSection } from './js/artist-section.js'\n\n// Чекаємо, доки DOM буде повністю завантажений, перш ніж ініціалізувати додаток\ndocument.addEventListener('DOMContentLoaded', () => {\n    initArtistSection();\n});\n\n"],"names":["api","axios","response","error","fetchArtists","fetchArtistById","id","offset","limit","allArtists","artistsContainer","loadMoreBtn","showLoader","loader","hideLoader","getGenres","artist","genres","g","val","idx","arr","genresFromFields","createCard","card","fullArtist","details","_a","img","h3","genresP","genresStrong","genresText","shortInfoP","bio","learnMoreButton","loadArtistsDataAndDisplay","data","artistsArray","artistsToDisplay","initArtistSection","e","artistId","artistData"],"mappings":"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"}